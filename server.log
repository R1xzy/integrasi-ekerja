
> sejasa-clone@0.1.0 dev
> next dev --turbopack

   ▲ Next.js 15.4.1 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://192.168.1.5:3000
   - Environments: .env

 ✓ Starting...
 ✓ Compiled middleware in 421ms
 ✓ Ready in 2.9s
 ○ Compiling /api/auth/login ...
 ✓ Compiled /api/auth/login in 3.9s
 POST /api/auth/login 200 in 4929ms
 ○ Compiling /api/providers/documents ...
 ✓ Compiled /api/providers/documents in 1201ms
🔄 POST /api/providers/documents - Starting request
🔐 Auth header: Present
✅ Auth successful for user ID: 7
🆔 Provider ID: 7
📦 Request body: {
  "documentType": "CERTIFICATE",
  "documentName": "Sertifikat Teknisi AC BNSP",
  "issuingOrganization": "BNSP",
  "credentialId": "BNSP-AC-2024-001",
  "fileUrl": "/uploads/documents/sertifikat-fanza-test.pdf",
  "issuedAt": "2024-06-15T00:00:00.000Z"
}
✅ Required fields present
✅ Document type valid: CERTIFICATE
✅ Date parsed: 2024-06-15T00:00:00.000Z
💾 Creating document in database...
✅ Document created successfully: 3
 POST /api/providers/documents 200 in 1642ms
 ○ Compiling /api/auth/register ...
 ✓ Compiled /api/auth/register in 1941ms
 POST /api/auth/register 409 in 2477ms
 POST /api/auth/register 200 in 3584ms
 ○ Compiling /api/email/registration-verification ...
 ✓ Compiled /api/email/registration-verification in 5s
 POST /api/email/registration-verification 409 in 6167ms
=== EMAIL DEMO MODE ===
To: fanza@gmail.com
Subject: Verifikasi Registrasi - eKerja Karawang
Email content would be sent in production mode
=======================
Registration verification email sent to: fanza@gmail.com
 POST /api/email/registration-verification 200 in 607ms
 PUT /api/email/registration-verification 400 in 216ms
 PUT /api/email/registration-verification 400 in 968ms
Registration verification successful for: fanza@gmail.com
 PUT /api/email/registration-verification 200 in 244ms
 PUT /api/email/registration-verification 400 in 304ms
 PUT /api/email/registration-verification 400 in 3608ms
=== EMAIL DEMO MODE ===
To: fanza@gmail.com
Subject: Verifikasi Registrasi - eKerja Karawang
Email content would be sent in production mode
=======================
Registration verification email sent to: fanza@gmail.com
 POST /api/email/registration-verification 200 in 792ms
Registration verification successful for: fanza@gmail.com
 PUT /api/email/registration-verification 200 in 457ms
 PUT /api/email/registration-verification 400 in 88ms
=== EMAIL DEMO MODE ===
To: fanza@gmail.com
Subject: Verifikasi Registrasi - eKerja Karawang
Email content would be sent in production mode
=======================
Registration verification email sent to: fanza@gmail.com
 POST /api/email/registration-verification 200 in 133ms
Registration verification successful for: fanza@gmail.com
 PUT /api/email/registration-verification 200 in 105ms
 ○ Compiling /api/email/password-reset-verification ...
 ✓ Compiled /api/email/password-reset-verification in 2.7s
 POST /api/email/password-reset-verification 200 in 3426ms
 PUT /api/email/password-reset-verification 400 in 114ms
 POST /api/email/password-reset-verification 200 in 1657ms
=== EMAIL DEMO MODE ===
To: provider@example.com
Subject: Reset Password - eKerja Karawang
Email content would be sent in production mode
=======================
Password reset verification email sent to: provider@example.com
 POST /api/email/password-reset-verification 200 in 201ms
Password reset verification successful for: provider@example.com
Password successfully reset for: provider@example.com
 PUT /api/email/password-reset-verification 200 in 348ms
 POST /api/auth/login 200 in 549ms
 POST /api/auth/login 401 in 176ms
 POST /api/email/registration-verification 409 in 251ms
=== EMAIL DEMO MODE ===
To: newuser@example.com
Subject: Verifikasi Registrasi - eKerja Karawang
Email content would be sent in production mode
=======================
Registration verification email sent to: newuser@example.com
 POST /api/email/registration-verification 200 in 916ms
=== EMAIL DEMO MODE ===
To: newuser@example.com
Subject: Verifikasi Registrasi - eKerja Karawang
Email content would be sent in production mode
=======================
Registration verification email sent to: newuser@example.com
 POST /api/email/registration-verification 200 in 133ms
=== EMAIL DEMO MODE ===
To: customer@example.com
Subject: Reset Password - eKerja Karawang
Email content would be sent in production mode
=======================
Password reset verification email sent to: customer@example.com
 POST /api/email/password-reset-verification 200 in 196ms
Registration verification successful for: newuser@example.com
 PUT /api/email/registration-verification 200 in 493ms
Password reset verification successful for: customer@example.com
Password successfully reset for: customer@example.com
 PUT /api/email/password-reset-verification 200 in 366ms
 POST /api/auth/login 200 in 229ms
=== EMAIL DEMO MODE ===
To: f@gmail.com
Subject: Verifikasi Registrasi - eKerja Karawang
Email content would be sent in production mode
=======================
Registration verification email sent to: f@gmail.com
 POST /api/email/registration-verification 200 in 726ms
Registration verification successful for: f@gmail.com
 PUT /api/email/registration-verification 200 in 240ms
 POST /api/email/password-reset-verification 200 in 901ms
 POST /api/email/password-reset-verification 200 in 511ms
 POST /api/email/password-reset-verification 200 in 106ms
=== EMAIL DEMO MODE ===
To: customer@example.com
Subject: Reset Password - eKerja Karawang
Email content would be sent in production mode
=======================
Password reset verification email sent to: customer@example.com
 POST /api/email/password-reset-verification 200 in 199ms
 POST /api/email/password-reset-verification 200 in 365ms
=== EMAIL DEMO MODE ===
To: customer.test@example.com
Subject: Reset Password - eKerja Karawang
Email content would be sent in production mode
=======================
Password reset verification email sent to: customer.test@example.com
 POST /api/email/password-reset-verification 200 in 547ms
Password reset verification successful for: customer.test@example.com
Password successfully reset for: customer.test@example.com
 PUT /api/email/password-reset-verification 200 in 683ms
=== EMAIL DEMO MODE ===
To: testuser@example.com
Subject: Verifikasi Registrasi - eKerja Karawang
Email content would be sent in production mode
=======================
Registration verification email sent to: testuser@example.com
 POST /api/email/registration-verification 200 in 225ms
🔄 Registration request received: {
  "fullName": "Test User",
  "email": "testuser@example.com",
  "password": "testpassword123",
  "phoneNumber": "081234567999",
  "roleId": 1,
  "verificationCode": "498838"
}
🔐 Verification code provided: 498838
💥 Registration error: Error [ZodError]: [
  {
    "origin": "string",
    "code": "invalid_format",
    "format": "regex",
    "pattern": "/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)/",
    "path": [
      "password"
    ],
    "message": "Password must contain uppercase, lowercase, and number"
  }
]
    at POST (src/app/api/auth/register/route.ts:23:41)
  21 |     
  22 |     // Validate request body (without verification code)
> 23 |     const validatedData = registerSchema.parse(registrationData);
     |                                         ^
  24 |     console.log('✅ Registration data validated');
  25 |     
  26 |     // Verify email verification code first
Stack trace: ZodError: [
  {
    "origin": "string",
    "code": "invalid_format",
    "format": "regex",
    "pattern": "/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)/",
    "path": [
      "password"
    ],
    "message": "Password must contain uppercase, lowercase, and number"
  }
]
    at POST (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/.next/server/chunks/[root-of-the-server]__22cccc10._.js:280:173)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async AppRouteRouteModule.do (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js:5:38782)
    at async AppRouteRouteModule.handle (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js:5:45984)
    at async responseGenerator (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/.next/server/chunks/node_modules_next_844b9dc1._.js:12851:38)
    at async AppRouteRouteModule.handleResponse (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js:1:183725)
    at async handleResponse (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/.next/server/chunks/node_modules_next_844b9dc1._.js:12913:32)
    at async handler (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/.next/server/chunks/node_modules_next_844b9dc1._.js:12965:13)
    at async doRender (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/base-server.js:1586:34)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/base-server.js:1928:13)
    at async DevServer.renderPageComponent (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/base-server.js:2394:24)
    at async DevServer.renderToResponseImpl (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/base-server.js:2434:32)
    at async DevServer.pipeImpl (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/base-server.js:1034:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/next-server.js:391:17)
    at async DevServer.handleRequestImpl (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/base-server.js:925:17)
    at async /Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/dev/next-dev-server.js:398:20
    at async Span.traceAsyncFn (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/trace/trace.js:157:20)
    at async DevServer.handleRequest (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/dev/next-dev-server.js:394:24)
    at async invokeRender (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/lib/router-server.js:239:21)
    at async handleRequest (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/lib/router-server.js:436:24)
    at async requestHandlerImpl (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/lib/router-server.js:464:13)
    at async Server.requestListener (/Users/fanzaatsilafizarli/Documents/Project/Next JS/next-ekerja/node_modules/next/dist/server/lib/start-server.js:218:13)
API Error: Error [ZodError]: [
  {
    "origin": "string",
    "code": "invalid_format",
    "format": "regex",
    "pattern": "/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)/",
    "path": [
      "password"
    ],
    "message": "Password must contain uppercase, lowercase, and number"
  }
]
    at POST (src/app/api/auth/register/route.ts:23:41)
  21 |     
  22 |     // Validate request body (without verification code)
> 23 |     const validatedData = registerSchema.parse(registrationData);
     |                                         ^
  24 |     console.log('✅ Registration data validated');
  25 |     
  26 |     // Verify email verification code first
 POST /api/auth/register 400 in 1400ms
🔄 Registration request received: {
  "fullName": "Test User",
  "email": "testuser@example.com",
  "password": "TestPassword123",
  "phoneNumber": "081234567999",
  "roleId": 1,
  "verificationCode": "498838"
}
🔐 Verification code provided: 498838
✅ Registration data validated
🔍 Verifying email verification code...
✅ Email verification successful
🔍 Checking if email already exists...
✅ Email and phone available
🔍 Validating role...
✅ Role validated: customer
🔐 Hashing password...
💾 Creating user in database...
✅ User created successfully: 5
🗑️ Cleaning up email verification code...
✅ Email verification code cleaned up
 POST /api/auth/register 200 in 725ms
 POST /api/auth/login 200 in 532ms
🔄 Registration request received: {
  "fullName": "Test User 2",
  "email": "testuser2@example.com",
  "password": "TestPassword123",
  "phoneNumber": "081234567888",
  "roleId": 1
}
 POST /api/auth/register 400 in 68ms
=== EMAIL DEMO MODE ===
To: testuser2@example.com
Subject: Verifikasi Registrasi - eKerja Karawang
Email content would be sent in production mode
=======================
Registration verification email sent to: testuser2@example.com
 POST /api/email/registration-verification 200 in 167ms
🔄 Registration request received: {
  "fullName": "Test User 2",
  "email": "testuser2@example.com",
  "password": "TestPassword123",
  "phoneNumber": "081234567888",
  "roleId": 1,
  "verificationCode": "999999"
}
🔐 Verification code provided: 999999
✅ Registration data validated
🔍 Verifying email verification code...
❌ Email verification failed
 POST /api/auth/register 400 in 118ms
=== EMAIL DEMO MODE ===
To: newprovider@example.com
Subject: Verifikasi Registrasi - eKerja Karawang
Email content would be sent in production mode
=======================
Registration verification email sent to: newprovider@example.com
 POST /api/email/registration-verification 200 in 104ms
🔄 Registration request received: {
  "fullName": "New Provider",
  "email": "newprovider@example.com",
  "password": "ProviderPassword123",
  "phoneNumber": "081234567777",
  "roleId": 2,
  "verificationCode": "257787"
}
🔐 Verification code provided: 257787
✅ Registration data validated
🔍 Verifying email verification code...
✅ Email verification successful
🔍 Checking if email already exists...
✅ Email and phone available
🔍 Validating role...
✅ Role validated: provider
🔐 Hashing password...
💾 Creating user in database...
✅ User created successfully: 6
🗑️ Cleaning up email verification code...
✅ Email verification code cleaned up
 POST /api/auth/register 200 in 541ms
 ✓ Compiled middleware in 33ms
